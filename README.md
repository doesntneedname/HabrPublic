---

# üìå Habr Career Integration Bot

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Habr Career API, –∫–æ—Ç–æ—Ä—ã–π:

‚úÖ –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ OAuth 2.0
‚úÖ –ó–∞–±–∏—Ä–∞–µ—Ç –æ—Ç–∫–ª–∏–∫–∏ –Ω–∞ –≤–∞–∫–∞–Ω—Å–∏–∏
‚úÖ –§–∏–ª—å—Ç—Ä—É–µ—Ç –Ω–æ–≤—ã–µ –æ—Ç–∫–ª–∏–∫–∏ (—Ç–æ–ª—å–∫–æ ¬´—Å–µ–≥–æ–¥–Ω—è¬ª)
‚úÖ –ö—ç—à–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏
‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–µ–±—Ö—É–∫ Pachca

---

## üöÄ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
habr/
  Dockerfile
  docker-compose.yml
  .env
  server.js
  package.json
  src/
    routes/
      auth.js
      vacancies.js
    lib/
      token.js
      cache.js
      habrApi.js
      webhook.js
      utils.js
    cron/
      jobs.js
```

---

## ‚ö°Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Habr OAuth 2.0
* –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –¥–æ—Å—Ç—É–ø–∞ –≤ —Ñ–∞–π–ª–µ
* –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ID –æ—Ç–∫–ª–∏–∫–æ–≤ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–æ–≤
* –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –æ—Ç–∫–ª–∏–∫–æ–≤ —á–µ—Ä–µ–∑ cron
* –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —á–∞—Ç Pachca
* –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π –¥–µ–Ω—å

---

## ‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* Node.js 20+
* Docker –∏ Docker Compose (–¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞)
* –î–æ–º–µ–Ω —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º HTTPS –∏ –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–µ—Ä–≤–µ—Ä—É
* –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ [Habr Career](https://career.habr.com) —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º Redirect URI
* –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–µ–±—Ö—É–∫–∞ Pachca (—Ç–æ–∫–µ–Ω –∏ URL)

---

## ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª **.env**.

**–ü—Ä–∏–º–µ—Ä:**

```
CLIENT_ID=your_habr_client_id
CLIENT_SECRET=your_habr_client_secret
REDIRECT_URI=https://localhost_or_your_domain/callback

AUTH_URL=https://career.habr.com/integrations/oauth/authorize
TOKEN_URL=https://career.habr.com/integrations/oauth/token
API_BASE_URL=https://career.habr.com/api/

SERVER_URL=localhost_or_your_domain

WEBHOOK_URL=your_pachca_webhook_url
BEARER_TOKEN=https://your_pachca_bearer_token
```

‚úÖ –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ:

* `REDIRECT_URI` –¥–æ–ª–∂–µ–Ω —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Habr.

---

## ‚úÖ –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–±–µ–∑ Docker)

1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

npm install

2Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

npm start

3Ô∏è‚É£ –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:

http://localhost:5000/

‚úÖ –ö–Ω–æ–ø–∫–∞ ¬´Login¬ª –æ—Ç–ø—Ä–∞–≤–∏—Ç –Ω–∞ Habr OAuth. –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤–µ—Ä–Ω—ë—Ç –Ω–∞ `/callback`.

---

## ‚úÖ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### 1Ô∏è‚É£ –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

docker-compose up --build

‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

* –ü–æ–¥—Ç—è–Ω–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env
* –ü—Ä–æ–∫–∏–Ω–µ—Ç –ø–æ—Ä—Ç 5000
* –°–º–æ–Ω—Ç–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–¥–ª—è –≥–æ—Ä—è—á–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)

---

### 2Ô∏è‚É£ –î–æ—Å—Ç—É–ø

‚úÖ –õ–æ–∫–∞–ª—å–Ω–æ:

http://localhost:5000

‚úÖ –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (—á–µ—Ä–µ–∑ Nginx –∏–ª–∏ –¥—Ä—É–≥–æ–π proxy):

https://your-domain.com

---

### 3Ô∏è‚É£ –ü—Ä–∏–º–µ—Ä Nginx-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```nginx
server {
    listen 443 ssl;
    server_name pachcaapi.ru;

    ssl_certificate     /etc/ssl/certs/your_cert.pem;
    ssl_certificate_key /etc/ssl/private/your_key.pem;

    location / {
        proxy_pass         http://localhost:5000;
        proxy_set_header   Host $host;
        proxy_set_header   X-Real-IP $remote_addr;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header   X-Forwarded-Proto $scheme;
    }
}
```

‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `REDIRECT_URI` –≤ .env —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —ç—Ç–∏–º –¥–æ–º–µ–Ω–æ–º:

```
REDIRECT_URI=https://localhost_or_your_domain/callback
```

---

## ‚úÖ Cron-–∑–∞–¥–∞—á–∏

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è:

‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –æ—Ç–∫–ª–∏–∫–æ–≤ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
cron
*/5 * * * *

‚úÖ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ –ø–æ–ª–Ω–æ—á—å (–ø–æ –ú–æ—Å–∫–≤–µ)
cron
0 0 * * *

---

## ‚úÖ –§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö

‚úÖ `access_token.txt`

* —Ö—Ä–∞–Ω–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–π OAuth-—Ç–æ–∫–µ–Ω Habr

‚úÖ `cache.json`

* —Å–ø–∏—Å–æ–∫ ID –æ—Ç–∫–ª–∏–∫–æ–≤, —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è

---

## ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

üîπ –ó–∞–ø—É—Å–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ª–æ–∫–∞–ª—å–Ω–æ):

npm start

üîπ –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –≤ Docker:

docker-compose up --build

üîπ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:

docker-compose down

---

## ‚úÖ –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

* [Habr Career OAuth](https://career.habr.com/integrations)
* [Pachca API](https://api.pachca.com)

---

## ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ:

‚úÖ –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/`
‚úÖ –ù–∞–∂–º–∏—Ç–µ ¬´Login¬ª
‚úÖ –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ Habr
‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç access_token

---

‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞:

* **routes** (–º–∞—Ä—à—Ä—É—Ç—ã)
* **lib** (–ª–æ–≥–∏–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –∫—ç—à)
* **cron** (–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏)

---
